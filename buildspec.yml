version: 0.2

phases:
  build:
    commands:
      # 빌드 시작 메시지 출력 (로깅용)
      - echo "[BUILD] Building the Spring Boot JAR..."

      # Gradle 빌드 실행 (테스트는 생략)
      - ./gradlew clean build -x test

      # 가장 최근 생성된 JAR 파일을 newsummarize.jar로 복사
      - - cp build/libs/backend-0.0.1-SNAPSHOT.jar newsummarize.jar

artifacts:
  files:
    # CodeDeploy에 전달할 파일 목록
    - newsummarize.jar              # 실행할 스프링 부트 JAR
    - appspec.yml                   # CodeDeploy 배포 설정
    - scripts/deploy.sh             # EC2에서 실행할 배포 스크립트

  discard-paths: yes               # 경로 제거하고 루트에 파일만 저장 (S3 내부 구조 단순화)
